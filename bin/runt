#!/usr/bin/env node

var exec = require('child_process').exec;
var runt = {};

function ex(command) {
  exec(command, function (err, stdout, stderr) {
    if (err) throw new Error(err);
    if (stdout) console.log(stdout);
    if (stderr) console.log(stderr);
  });
}

runt.build = function build(argv) {
  if (argv.dev || argv.D) {
    ex('./scripts/build-dev');
  } else {
    ex('./scripts/build');
  }
};

runt.test = function test(argv) {
  ex('./scripts/test');
};

runt.release = function release(argv) {
  if (argv.preview || argv.P) {
    ex('./scripts/release-preview');
  } else {
    ex('./scripts/release');
  }
};

runt.pages = function pages(argv) {
  console.log('pages...');
};

runt.help = function help() {
  console.log('Usage: runt <command> [<args>]');
  console.log('');
  console.log('Available commands:');
  console.log(' build     Build the project and copy the generated files to dist/');
  console.log(' test      Run the test suite');
  console.log(' release   Publish a new release to npm');
  console.log(' pages     Deploy the example to gh-pages');
  console.log(' help      Show this help');
};

function main(argv) {
  if (argv._[0] && typeof runt[argv._[0]] === 'function') {
    runt[argv._[0]](argv);
  } else {
    runt.help();
  }
}

main(require('minimist')(process.argv.slice(2)));
